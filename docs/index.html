<!DOCTYPE html>
<head>
    <title>Jeff Hykin</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="https://unpkg.com/css-baseline/css/3.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Roboto');
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@100&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap');
        :root {
            --gray-pallet-background: rgb(30, 37, 53);
            --red-pallet-background: lightcoral;
            --off-white: hsl(0, 0%, 87.8%);
            --charcoal: hsl(180, 0%, 31%);
            --charcoal-on-charcoal: hsl(0deg 0% 50%);
            --soft-gray-gradient: linear-gradient(-110deg, whitesmoke, var(--off-white));
            /* misc */
            --red-pallet-font: white;
            --decent-color-1: lightcoral;
            --decent-color-2: salmon;
            --decent-color-3: lightpink;
            --decent-color-4: lightsalmon;
            --decent-color-5: coral;
            --decent-color-6: lightcyan;
            --decent-color-7: lightblue;
            --decent-color-8: lightsteelblue;
            --decent-color-9: skyblue;
            --decent-color-10: lightskyblue;
            --decent-color-11: cornflowerblue;
            --decent-color-12: dodgerblue;
            --decent-color-13: aquamarine;
            --decent-color-14: turquoise;
            --decent-color-15: darkturquoise;
            --decent-color-16: lightseagreen;
            --decent-color-17: darkcyan;
            --decent-color-18: teal;
            --decent-color-19: mediumspringgreen;
            --decent-color-20: lightgreen;
            --decent-color-21: cadetblue;
            --decent-color-22: darkorchid;
            --decent-color-23: blueviolet;
        }
        body {
            font-size: 0.9em;
            font-family: Roboto;
        }
        .animate {
            transition: all 0.5s ease-in-out 0s;
        }
        .weak-shadow {
            transition: all 0.3s ease-in-out 0s;
            box-shadow: 0 4px 5px 0 rgba(0,0,0,0.10),0 1px 10px 0 rgba(0,0,0,0.08),0 2px 4px -1px rgba(0,0,0,0.24);
        }
        .weak-shadow:hover {
            box-shadow: 0 8px 17px 2px rgba(0,0,0,0.10),0 6px 30px 5px rgba(0,0,0,0.08),0 8px 10px -7px rgba(0,0,0,0.16);
        }
        button {
            border-radius: 1em;
            border: none;
            background-color: cornflowerblue;
            padding: 0.5em 1em;
            color: white;
        }
        a {
            color: lightskyblue;
            text-decoration: underline;
        }
        span {
            vertical-align: text-top;
        }
    </style>
</head>
<!--                                   -->
<!-- Synchonous/Fast loading animation -->
<!--                                   -->
    <body>
        <div style="display: flex;justify-content: center;align-items: center;height: 100vh;">
            <div style="width: 50px;height: 50px;border: 10px solid #dddddd;border-top-color: #009579;border-radius: 50%;transform: rotate(0.16turn);" id="good-component--initial-loader">
            </div>
        </div>
    </body>
    <script>
        // 
        // Synchonous/Fast loading animation
        // 
            const animateLoader = ()=>{
            const element = document.getElementById("good-component--initial-loader")
                element && element.animate(
                    [
                        { transform: 'rotate(0turn)' },
                        { transform: 'rotate(1turn)' },
                    ],
                    {
                        duration: 1000,
                        iterations: Infinity,
                        easing: 'ease',
                    },
                )
            }
            document.body ? animateLoader() : document.addEventListener("DOMContentLoaded", animateLoader)
    </script>

<!--          -->
<!-- Toastify -->
<!--          -->
<script type="module">
    // 
    // Toast
    // 
        import { css, cx } from 'https://cdn.skypack.dev/-/@emotion/css@v11.10.5-uWGULTiBZCR27o2j9H2P/dist=es2019,mode=imports/optimized/@emotion/css.js'
    
        const toastOn = css``
        const toastify = css`
            padding: 12px 20px;
            color: #ffffff;
            display: inline-block;
            box-shadow: 0 3px 6px -1px rgba(0, 0, 0, 0.12), 0 10px 36px -4px rgba(77, 96, 232, 0.3);
            background: -webkit-linear-gradient(315deg, #73a5ff, #5477f5);
            background: linear-gradient(135deg, #73a5ff, #5477f5);
            position: fixed;
            opacity: 0;
            transition: all 0.4s cubic-bezier(0.215, 0.61, 0.355, 1);
            border-radius: 2px;
            cursor: pointer;
            text-decoration: none;
            max-width: calc(50% - 20px);
            z-index: 2147483647;
            &${toastOn} {
                opacity: 1;
            }
        `


        const toastClose = css`
            background: transparent;
            border: 0;
            color: white;
            cursor: pointer;
            font-family: inherit;
            font-size: 1em;
            opacity: 0.4;
            padding: 0 5px;
        `

        const toastifyRight = css`
            right: 15px;
            @media only screen and (max-width: 360px) {
                margin-left: auto;
                margin-right: auto;
                left: 0;
                right: 0;
                max-width: fit-content;
            }
        `

        const toastifyLeft = css`
            left: 15px;
            @media only screen and (max-width: 360px) {
                margin-left: auto;
                margin-right: auto;
                left: 0;
                right: 0;
                max-width: fit-content;
            }
        `

        const toastifyTop = css`
            top: 50px;
        `

        const toastifyBottom = css`
            bottom: 50px;
        `

        const toastifyRounded = css`
            border-radius: 25px;
        `

        const toastifyAvatar = css`
            width: 1.5em;
            height: 1.5em;
            margin: -7px 5px;
            border-radius: 2px;
        `

        const toastifyCenter = css`
            margin-left: auto;
            margin-right: auto;
            left: 0;
            right: 0;
            max-width: fit-content;
            max-width: -moz-fit-content;
        `

        const nameMapping = {
            right: toastifyRight,
            left: toastifyLeft,
            top: toastifyTop,
            bottom: toastifyBottom,
            rounded: toastifyRounded,
            avatar: toastifyAvatar,
            center: toastifyCenter,
        }

        /*!
        * Toastify js 1.12.0
        * https://github.com/apvarun/toastify-js
        * @license MIT licensed
        *
        * Copyright (C) 2018 Varun A P
        */

        /**
        * Options used for Toastify
        * @typedef {Object} ToastifyConfigurationObject
        * @property {string} text - Message to be displayed in the toast
        * @property {Element} node - Provide a node to be mounted inside the toast. node takes higher precedence over text
        * @property {number} duration - Duration for which the toast should be displayed. -1 for permanent toast
        * @property {string|Element} selector - CSS ID Selector on which the toast should be added
        * @property {url} destination - URL to which the browser should be navigated on click of the toast
        * @property {boolean} newWindow - Decides whether the destination should be opened in a new window or not
        * @property {boolean} close - To show the close icon or not
        * @property {string} gravity - To show the toast from top or bottom
        * @property {string} position - To show the toast on left or right
        * @property {string} backgroundColor - Deprecated: Sets the background color of the toast
        * @property {url} avatar - Image/icon to be shown before text
        * @property {string} className - Ability to provide custom class name for further customization
        * @property {boolean} stopOnFocus - To stop timer when hovered over the toast (Only if duration is set)
        * @property {Function} callback - Invoked when the toast is dismissed
        * @property {Function} onClick - Invoked when the toast is clicked
        * @property {Object} offset - Ability to add some offset to axis
        * @property {boolean} escapeMarkup - Toggle the default behavior of escaping HTML markup
        * @property {string} ariaLive - Use the HTML DOM style property to add styles to toast
        * @property {Object} style - Use the HTML DOM style property to add styles to toast
        */

        class Toastify {
            defaults = {
                oldestFirst: true,
                text: "Toastify is awesome!",
                node: undefined,
                duration: 3000,
                selector: undefined,
                callback: function () {},
                destination: undefined,
                newWindow: false,
                close: false,
                gravity: toastifyBottom,
                positionLeft: false,
                position: "",
                backgroundColor: "",
                avatar: "",
                className: "",
                stopOnFocus: true,
                onClick: function () {},
                offset: { x: 0, y: 0 },
                escapeMarkup: true,
                ariaLive: "polite",
                style: { background: "" },
            }
            
            /**
            * Init the Toastify class
            * @example
            *     new Toastify({
            *         text: "This is a toast",
            *         duration: 3000
            *     }).showToast()
            *
            * @param {ToastifyConfigurationObject} options - The configuration object to configure Toastify
            * @param {string} [options.text=Hi there!] - Message to be displayed in the toast
            * @param {Element} [options.node] - Provide a node to be mounted inside the toast. node takes higher precedence over text
            * @param {number} [options.duration=3000] - Duration for which the toast should be displayed. -1 for permanent toast
            * @param {string} [options.selector] - CSS Selector on which the toast should be added
            * @param {url} [options.destination] - URL to which the browser should be navigated on click of the toast
            * @param {boolean} [options.newWindow=false] - Decides whether the destination should be opened in a new window or not
            * @param {boolean} [options.close=false] - To show the close icon or not
            * @param {string} [options.gravity=toastify-top] - To show the toast from top or bottom
            * @param {string} [options.position=right] - To show the toast on left or right
            * @param {string} [options.backgroundColor] - Sets the background color of the toast (To be deprecated)
            * @param {url} [options.avatar] - Image/icon to be shown before text
            * @param {string} [options.className] - Ability to provide custom class name for further customization
            * @param {boolean} [options.stopOnFocus] - To stop timer when hovered over the toast (Only if duration is set)
            * @param {Function} [options.callback] - Invoked when the toast is dismissed
            * @param {Function} [options.onClick] - Invoked when the toast is clicked
            * @param {Object} [options.offset] - Ability to add some offset to axis
            * @param {boolean} [options.escapeMarkup=true] - Toggle the default behavior of escaping HTML markup
            * @param {string} [options.ariaLive] - Announce the toast to screen readers
            * @param {Object} [options.style] - Use the HTML DOM style property to add styles to toast
            */
            constructor(options) {
                /**
                * The version of Toastify
                * @type {string}
                * @public
                */
                this.version = "1.12.0"

                /**
                * The configuration object to configure Toastify
                * @type {ToastifyConfigurationObject}
                * @public
                */
                this.options = {}

                /**
                * The element that is the Toast
                * @type {Element}
                * @public
                */
                this.toastElement = null

                /**
                * The root element that contains all the toasts
                * @type {Element}
                * @private
                */
                this._rootElement = document.body

                // Setting defaults
                this.options = Object.assign(this.defaults, options)

                if (this.options.backgroundColor) {
                    // This is being deprecated in favor of using the style HTML DOM property
                    console.warn('DEPRECATION NOTICE: "backgroundColor" is being deprecated. Please use the "style.background" property.')
                }

                this.toastElement = null

                this.options.gravity = options.gravity === "bottom" ? toastifyBottom : toastifyTop // toast position - top or bottom
                this.options.stopOnFocus = options.stopOnFocus === undefined ? true : options.stopOnFocus // stop timeout on focus
                if (options.backgroundColor) {
                    this.options.style.background = options.backgroundColor
                }
            }

            /**
            * Display the toast
            * @public
            */
            showToast() {
                // Creating the DOM object for the toast
                this.toastElement = this._buildToast()

                // Getting the root element to with the toast needs to be added
                if (typeof this.options.selector === "string") {
                    this._rootElement = document.getElementById(this.options.selector)
                } else if (this.options.selector instanceof HTMLElement || this.options.selector instanceof ShadowRoot) {
                    this._rootElement = this.options.selector
                } else {
                    this._rootElement = document.body
                }

                // Validating if root element is present in DOM
                if (!this._rootElement) {
                    throw "Root element is not defined"
                }

                // Adding the DOM element
                this._rootElement.insertBefore(this.toastElement, this._rootElement.firstChild)

                // Repositioning the toasts in case multiple toasts are present
                this._reposition()

                if (this.options.duration > 0) {
                    this.toastElement.timeOutValue = window.setTimeout(() => {
                        // Remove the toast from DOM
                        this._removeElement(this.toastElement)
                    }, this.options.duration) // Binding `this` for function invocation
                }

                // Supporting function chaining
                return this
            }

            /**
            * Hide the toast
            * @public
            */
            hideToast() {
                if (this.toastElement.timeOutValue) {
                    clearTimeout(this.toastElement.timeOutValue)
                }
                this._removeElement(this.toastElement)
            }

            /**
            * Build the Toastify element
            * @returns {Element}
            * @private
            */
            _buildToast() {
                // Validating if the options are defined
                if (!this.options) {
                    throw "Toastify is not initialized"
                }

                // Creating the DOM object
                let divElement = document.createElement("div")
                divElement.className = `${toastify} ${toastOn} ${this.options.className}`

                // Positioning toast to left or right or center (default right)
                divElement.className += ` ${nameMapping[this.options.position]}`

                // Assigning gravity of element
                divElement.className += ` ${this.options.gravity}`

                // Loop through our style object and apply styles to divElement
                for (const property in this.options.style) {
                    divElement.style[property] = this.options.style[property]
                }

                // Announce the toast to screen readers
                if (this.options.ariaLive) {
                    divElement.setAttribute("aria-live", this.options.ariaLive)
                }

                // Adding the toast message/node
                if (this.options.node && this.options.node.nodeType === Node.ELEMENT_NODE) {
                    // If we have a valid node, we insert it
                    divElement.appendChild(this.options.node)
                } else {
                    if (this.options.escapeMarkup) {
                        divElement.innerText = this.options.text
                    } else {
                        divElement.innerHTML = this.options.text
                    }

                    if (this.options.avatar !== "") {
                        let avatarElement = document.createElement("img")
                        avatarElement.src = this.options.avatar

                        avatarElement.className = toastifyAvatar

                        if (this.options.position == "left") {
                            // Adding close icon on the left of content
                            divElement.appendChild(avatarElement)
                        } else {
                            // Adding close icon on the right of content
                            divElement.insertAdjacentElement("afterbegin", avatarElement)
                        }
                    }
                }

                // Adding a close icon to the toast
                if (this.options.close === true) {
                    // Create a span for close element
                    let closeElement = document.createElement("button")
                    closeElement.type = "button"
                    closeElement.setAttribute("aria-label", "Close")
                    closeElement.className = toastClose
                    closeElement.innerHTML = "&#10006;"

                    // Triggering the removal of toast from DOM on close click
                    closeElement.addEventListener("click", (event) => {
                        event.stopPropagation()
                        this._removeElement(this.toastElement)
                        window.clearTimeout(this.toastElement.timeOutValue)
                    })

                    //Calculating screen width
                    const width = window.innerWidth > 0 ? window.innerWidth : screen.width

                    // Adding the close icon to the toast element
                    // Display on the right if screen width is less than or equal to 360px
                    if (this.options.position == "left" && width > 360) {
                        // Adding close icon on the left of content
                        divElement.insertAdjacentElement("afterbegin", closeElement)
                    } else {
                        // Adding close icon on the right of content
                        divElement.appendChild(closeElement)
                    }
                }

                // Clear timeout while toast is focused
                if (this.options.stopOnFocus && this.options.duration > 0) {
                    // stop countdown
                    divElement.addEventListener("mouseover", (event) => {
                        window.clearTimeout(divElement.timeOutValue)
                    })
                    // add back the timeout
                    divElement.addEventListener("mouseleave", () => {
                        divElement.timeOutValue = window.setTimeout(() => {
                            // Remove the toast from DOM
                            this._removeElement(divElement)
                        }, this.options.duration)
                    })
                }

                // Adding an on-click destination path
                if (typeof this.options.destination !== "undefined") {
                    divElement.addEventListener("click", (event) => {
                        event.stopPropagation()
                        if (this.options.newWindow === true) {
                            window.open(this.options.destination, "_blank")
                        } else {
                            window.location = this.options.destination
                        }
                    })
                }

                if (typeof this.options.onClick === "function" && typeof this.options.destination === "undefined") {
                    divElement.addEventListener("click", (event) => {
                        event.stopPropagation()
                        this.options.onClick()
                    })
                }

                // Adding offset
                if (typeof this.options.offset === "object") {
                    const x = this._getAxisOffsetAValue("x", this.options)
                    const y = this._getAxisOffsetAValue("y", this.options)

                    const xOffset = this.options.position == "left" ? x : `-${x}`
                    const yOffset = this.options.gravity == toastifyTop ? y : `-${y}`

                    divElement.style.transform = `translate(${xOffset},${yOffset})`
                }

                // Returning the generated element
                return divElement
            }

            /**
            * Remove the toast from the DOM
            * @param {Element} toastElement
            */
            _removeElement(toastElement) {
                // Hiding the element
                toastElement.className = toastElement.className.replace(` ${toastOn}`, "")

                // Removing the element from DOM after transition end
                window.setTimeout(() => {
                    // remove options node if any
                    if (this.options.node && this.options.node.parentNode) {
                        this.options.node.parentNode.removeChild(this.options.node)
                    }

                    // Remove the element from the DOM, only when the parent node was not removed before.
                    if (toastElement.parentNode) {
                        toastElement.parentNode.removeChild(toastElement)
                    }

                    // Calling the callback function
                    this.options.callback.call(toastElement)

                    // Repositioning the toasts again
                    this._reposition()
                }, 400) // Binding `this` for function invocation
            }

            /**
            * Position the toast on the DOM
            * @private
            */
            _reposition() {
                // Top margins with gravity
                let topLeftOffsetSize = {
                    top: 15,
                    bottom: 15,
                }
                let topRightOffsetSize = {
                    top: 15,
                    bottom: 15,
                }
                let offsetSize = {
                    top: 15,
                    bottom: 15,
                }

                // Get all toast messages that have been added to the container (selector)
                let allToasts = this._rootElement.querySelectorAll(`.${toastify}`)

                let classUsed
                let topOrBottom

                // Modifying the position of each toast element
                for (let i = 0; i < allToasts.length; i++) {
                    // Getting the applied gravity
                    if (allToasts[i].classList.contains(toastifyTop) === true) {
                        classUsed = toastifyTop
                        topOrBottom = "top"
                    } else {
                        classUsed = toastifyBottom
                        topOrBottom = "bottom"
                    }

                    let height = allToasts[i].offsetHeight
                    classUsed = classUsed.substr(9, classUsed.length - 1)
                    // Spacing between toasts
                    let offset = 15

                    let width = window.innerWidth > 0 ? window.innerWidth : screen.width

                    // Show toast in center if screen with less than or equal to 360px
                    if (width <= 360) {
                        // Setting the position
                        allToasts[i].style[topOrBottom] = `${offsetSize[topOrBottom]}px`

                        offsetSize[topOrBottom] += height + offset
                    } else {
                        if (allToasts[i].classList.contains(toastifyLeft) === true) {
                            // Setting the position
                            allToasts[i].style[topOrBottom] = `${topLeftOffsetSize[topOrBottom]}px`

                            topLeftOffsetSize[topOrBottom] += height + offset
                        } else {
                            // Setting the position
                            allToasts[i].style[topOrBottom] = `${topRightOffsetSize[topOrBottom]}px`

                            topRightOffsetSize[topOrBottom] += height + offset
                        }
                    }
                }
            }

            /**
            * Helper function to get offset
            * @param {string} axis - 'x' or 'y'
            * @param {ToastifyConfigurationObject} options - The options object containing the offset object
            */
            _getAxisOffsetAValue(axis, options) {
                if (options.offset[axis]) {
                    if (isNaN(options.offset[axis])) {
                        return options.offset[axis]
                    } else {
                        return `${options.offset[axis]}px`
                    }
                }

                return "0px"
            }
        }
        window.Toastify = Toastify
    // example:
    //     new Toastify({
    //         text: message,
    //         position: 'right',
    //         backgroundColor: "#ef6c00",
    //         gravity: "bottom",
    //         duration: 8000,
    //     }).showToast()
</script>
<!--                -->
<!-- The main code  -->
<!--                -->
<script type="module">//;(async () => {
    // 
    // 
    // theme
    // 
    // 
        const theme = {
            farBackground: "#212B38",
            closeBackground: "#37465B",
            foregroundDim: "#08C6AB",
            foregroundBright: "#5AFFE7",
            accent: "#726EFF",
        }
    // 
    // 
    // Initialize
    // 
    // 
        import { zip, enumerate, count, permute, combinations, wrapAroundGet } from "https://deno.land/x/good@1.5.1.0/array.js"
         // const ElementalLibrary = (await import("https://cdn.skypack.dev/@!!!!!/elemental@0.0.12")).default
        // const ContainerLibrary = (await import("https://cdn.skypack.dev/@!vanilla/container@v1.0.5")).default
        // inlined version of what is above
        // const [ ElementalLibrary, ContainerLibrary ] = (()=>{var e = "\uE000", t = "\uE001"; function o(r2) {  var p2, a1, l, s, c = arguments, i = this, n = 0, d = [], h = 0, u = [], f = 0;  d.root = true;  var g = function(e2, o2, r3) {  o2 === void 0 && (o2 = []);  var p3 = 0;  return (e2 = r3 || e2 !== t ? e2.replace(/\ue001/g, (e3)=>u[f++]  ) : u[f++].slice(1, -1)) ? (e2.replace(/\ue000/g, (t2, r4)=>(r4 && o2.push(e2.slice(p3, r4)), p3 = r4 + 1, o2.push(c[++h]))  ), p3 < e2.length && o2.push(e2.slice(p3)), o2.length > 1 ? o2 : o2[0]) : e2;  }, m = ()=>{  [d, s, ...p2] = d, d.push(i(s, ...p2));  };  return r2.join(e).replace(/<!--[^]*-->/g, "").replace(/<!\[CDATA\[[^]*\]\]>/g, "").replace(/('|")[^\1]*?\1/g, (e2)=>(u.push(e2), t)  ).replace(/\s+/g, " ").replace(/(?:^|>)([^<]*)(?:$|<)/g, (e2, t2, r3, p3)=>{  var c2, i2;  if (r3 && p3.slice(n, r3).replace(/(\S)\/$/, "$1 /").split(" ").map((e3, t3)=>{  if (e3[0] === "/") c2 = i2 || e3.slice(1) || 1;  else if (t3) {  if (e3) {  var r4 = d[2] || (d[2] = {});  e3.slice(0, 3) === "..." ? Object.assign(r4, arguments[++h]) : ([a1, l] = e3.split("="), r4[g(a1)] = !l || g(l));  }  } else {  for(i2 = g(e3); o.close[d[1] + i2];)m();  d = [  d,  i2,  null  ], o.empty[i2] && (c2 = i2);  }  }), c2) for(m(); s !== c2 && o.close[s];)m();  n = r3 + e2.length, t2 && t2 !== " " && g((s = 0, t2), d, true);  }), d.root || m(), d.length > 1 ? d : d[0]; } o.empty = {}, o.close = {}, "area base br col command embed hr img input keygen link meta param source track wbr ! !doctype ? ?xml".split(" ").map((e2)=>o.empty[e2] = o.empty[e2.toUpperCase()] = true ); var r = {  li: "",  dt: "dd",  dd: "dt",  p: "address article aside blockquote details div dl fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 header hgroup hr main menu nav ol pre section table",  rt: "rp",  rp: "rt",  optgroup: "",  option: "optgroup",  caption: "tbody thead tfoot tr colgroup",  colgroup: "thead tbody tfoot tr caption",  thead: "tbody tfoot caption",  tbody: "tfoot caption",  tfoot: "caption",  tr: "tbody tfoot",  td: "th tr",  th: "td tr tbody" }, p = function(e2) {  [  ...r[e2].split(" "),  e2  ].map((t2)=>{  o.close[e2] = o.close[e2.toUpperCase()] = o.close[e2 + t2] = o.close[e2.toUpperCase() + t2] = o.close[e2 + t2.toUpperCase()] = o.close[e2.toUpperCase() + t2.toUpperCase()] = true;  }); }; for(var a in r)p(a); const xhtm = o; class Elemental {  constructor(components = {}, options = {}){  const { middleware: middleware2 , errorComponentFactory } = options;  this.components = components || {};  this.middleware = middleware2 || {};  this.errorComponentFactory = errorComponentFactory || defaultErrorComponentFactory;  this.html = xhtm.bind((...args)=>this.createElement(...args)  );  this.css = Elemental.css;  }  createElement(...args) {  Elemental.debug && console.debug(`args is:`, args);  for (const middleware2 of (this.middleware[Elemental.allTags] || []).concat(this.middleware[args[0]] || [])){  try {  args = eachMiddleWare(args);  } catch (error) {  console.error("[elemental] one of the middleware functions failed:", eachMiddleWare, args);  }  }  let [key, properties, ...children] = args;  Elemental.debug && console.debug(`key, properties, children is:`, key, properties, children);  if (this.components[key] instanceof Function) {  key = this.components[key];  }  if (key instanceof Function) {  let output;  try {  output = isConstructor(key) ? new key({  ...properties,  children  }) : key({  ...properties,  children  });  } catch (error) {  return this.errorComponentFactory({  ...properties,  children  }, key, error);  }  if (output instanceof Promise) {  const elementPromise = output;  const placeholder = elementPromise.placeholder || document.createElement("div");  setTimeout(async ()=>placeholder.replaceWith(await elementPromise)  , 0);  return placeholder;  } else {  return output;  }  }  const isSvg = Elemental.exclusivelySvgElements.has(key);  const element = isSvg ? document.createElementNS("http://www.w3.org/2000/svg", key) : document.createElement(key);  if (properties instanceof Object) {  for (const [key2, value] of Object.entries(properties)){  try {  if (isSvg) {  const kebabCase = key2.replace(/(?<=[a-z])([A-Z])(?=[a-z])/g, (each2)=>`-${each2.toLowerCase()}`  );  element.setAttribute(kebabCase, value);  } else {  element.setAttribute(key2.toLowerCase(), value);  }  } catch (error) {}  try {  element[key2] = value;  } catch (error1) {}  }  }  return appendChildren(element, ...children);  }  extend(additionalComponents = {}, options = {}) {  const { additionalMiddleware , ...other } = options;  return new Elemental({  ...this.components,  ...additionalComponents  }, {  middleware: {  ...this.middleware,  ...middleware  },  ...other  });  } } Elemental.allTags = Symbol.for("allTags"); Elemental.exclusivelySvgElements = new Set([  "svg",  "animate",  "animateMotion",  "animateTransform",  "circle",  "clipPath",  "defs",  "desc",  "discard",  "ellipse",  "feBlend",  "feColorMatrix",  "feComponentTransfer",  "feComposite",  "feConvolveMatrix",  "feDiffuseLighting",  "feDisplacementMap",  "feDistantLight",  "feDropShadow",  "feFlood",  "feFuncA",  "feFuncB",  "feFuncG",  "feFuncR",  "feGaussianBlur",  "feImage",  "feMerge",  "feMergeNode",  "feMorphology",  "feOffset",  "fePointLight",  "feSpecularLighting",  "feSpotLight",  "feTile",  "feTurbulence",  "filter",  "foreignObject",  "g",  "hatch",  "hatchpath",  "image",  "line",  "linearGradient",  "marker",  "mask",  "mesh",  "meshgradient",  "meshpatch",  "meshrow",  "metadata",  "mpath",  "path",  "pattern",  "polygon",  "polyline",  "radialGradient",  "rect",  "set",  "stop",  "switch",  "symbol",  "text",  "textPath",  "tspan",  "unknown",  "use",  "view" ]); Elemental.css = function(...args) {  const element = document.createElement("div");  if (args.length == 1) {  if (args instanceof Object) {  Object.assign(element.style, args);  }  } else if (args.length > 1) {  const [strings, ...values] = args;  let finalString = "";  for (const each2 of strings){  finalString += each2;  if (values.length > 0) {  finalString += `${values.shift()}`;  }  }  element.style = finalString;  }  return element.style; }; function appendChildren(element, ...children) {  for (const each2 of children){  if (typeof each2 == "string") {  element.appendChild(new window.Text(each2));  } else if (each2 == null) {  element.appendChild(new window.Text(""));  } else if (!(each2 instanceof Object)) {  element.appendChild(new window.Text(`${each2}`));  } else if (each2 instanceof Node) {  element.appendChild(each2);  } else if (each2 instanceof Array) {  appendChildren(element, ...each2);  } else if (each2 instanceof Function) {  appendChildren(element, each2());  } else if (each2 instanceof Promise) {  const elementPromise = each2;  const placeholder = elementPromise.placeholder || document.createElement("div");  setTimeout(async ()=>placeholder.replaceWith(await elementPromise)  , 0);  element.appendChild(placeholder);  } else if (each2 != null && each2 instanceof Object) {  element.appendChild(each2);  }  }  return element; } function defaultErrorComponentFactory({ children , ...properties }, key, error) {  const element = document.createElement("div");  const errorDetails = document.createElement("code");  const childContainer = document.createElement("div");  element.style.all = "unset";  element.style.display = "flex";  element.style.flexDirection = "column";  element.style.padding = "1.5em";  element.style.backgroundColor = "#f5a5a8";  element.style.color = "white";  element.style.fontFamily = '-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif';  element.style.fontSize = "18px";  element.style.fontWeight = "400";  element.style.overflow = "auto";  element.innerHTML = `I'm sorry, there was an error when loading this part of the page \u{1F641} `;  let errorElementPart;  if (typeof key == "string") {  errorElementPart = `<${key} />`;  } else {  try {  errorElementPart = `<${key.prototype.constructor.name} />`;  } catch (error2) {  errorElementPart = `<${key} />`;  }  }  let errorJsonObject = {};  for (const [key2, value] of Object.entries(properties)){  try {  errorJsonObject[key2] = JSON.parse(JSON.stringify(value));  } catch (error2) {  errorJsonObject[key2] = `${value}`;  }  }  errorDetails.innerHTML = `tag: ${errorElementPart} properties: ${JSON.stringify(errorJsonObject)} error: ${error}`;  errorDetails.style.padding = "1em";  errorDetails.style.backgroundColor = "#161b22";  errorDetails.style.color = "#789896";  element.appendChild(errorDetails);  childContainer.style.all = "unset";  childContainer.style.display = "flex";  childContainer.style.flexDirection = "column";  childContainer.style.marginTop = "1.3em";  if (children instanceof Array) {  for (const [key2, value] of Object.entries(children)){  if (typeof each == "string") {  childContainer.appendChild(new window.Text(value));  } else if (value instanceof Node) {  childContainer.appendChild(value);  }  }  }  element.appendChild(childContainer);  return element; } function isConstructor(obj) {  return !!obj.prototype && !!obj.prototype.constructor.name; } const originalHead = document.head; Object.defineProperty(document, "head", {  set: (element)=>appendChildren(originalHead, ...element.childNodes)  ,  get: ()=>originalHead }); const html = new Elemental().html; const css = Elemental.css; const allTags = Elemental.allTags; var ElementalLibrary = {  Elemental,  html,  css,  allTags }; const htmlEventHandlers = new Set([  "onabort",  "onanimationcancel",  "onanimationend",  "onanimationiteration",  "onanimationstart",  "onauxclick",  "onblur",  "onerror",  "onfocus",  "oncancel",  "oncanplay",  "oncanplaythrough",  "onchange",  "onclick",  "onclose",  "oncontextmenu",  "oncuechange",  "ondblclick",  "ondrag",  "ondragend",  "ondragenter",  "ondragleave",  "ondragover",  "ondragstart",  "ondrop",  "ondurationchange",  "onemptied",  "onended",  "onformdata",  "ongotpointercapture",  "oninput",  "oninvalid",  "onkeydown",  "onkeypress",  "onkeyup",  "onload",  "onloadeddata",  "onloadedmetadata",  "onloadend",  "onloadstart",  "onlostpointercapture",  "onmousedown",  "onmouseenter",  "onmouseleave",  "onmousemove",  "onmouseout",  "onmouseover",  "onmouseup",  "onmousewheel",  "onwheel",  "onpause",  "onplay",  "onplaying",  "onpointerdown",  "onpointermove",  "onpointerup",  "onpointercancel",  "onpointerover",  "onpointerout",  "onpointerenter",  "onpointerleave",  "onpointerlockchange",  "onpointerlockerror",  "onprogress",  "onratechange",  "onreset",  "onresize",  "onscroll",  "onsecuritypolicyviolation",  "onseeked",  "onseeking",  "onselect",  "onselectstart",  "onselectionchange",  "onshow",  "onslotchange",  "onstalled",  "onsubmit",  "onsuspend",  "ontimeupdate",  "onvolumechange",  "ontouchcancel",  "ontouchend",  "ontouchmove",  "ontouchstart",  "ontransitioncancel",  "ontransitionend",  "ontransitionrun",  "ontransitionstart",  "onwaiting" ]); const fixedAttributes = new Set([  "accept",  "accept-charset",  "accesskey",  "action",  "align",  "allow",  "alt",  "async",  "autocapitalize",  "autocomplete",  "autofocus",  "autoplay",  "background",  "bgcolor",  "border",  "buffered",  "capture",  "challenge",  "charset",  "checked",  "cite",  "class",  "code",  "codebase",  "color",  "cols",  "colspan",  "content",  "contenteditable",  "contextmenu",  "controls",  "coords",  "crossorigin",  "csp",  "data",  "datetime",  "decoding",  "default",  "defer",  "dir",  "dirname",  "disabled",  "download",  "draggable",  "enctype",  "enterkeyhint",  "for",  "form",  "formaction",  "formenctype",  "formmethod",  "formnovalidate",  "formtarget",  "headers",  "height",  "hidden",  "high",  "href",  "hreflang",  "http-equiv",  "icon",  "id",  "importance",  "integrity",  "intrinsicsize",  "inputmode",  "ismap",  "itemprop",  "keytype",  "kind",  "label",  "lang",  "language",  "loading",  "list",  "loop",  "low",  "manifest",  "max",  "maxlength",  "minlength",  "media",  "method",  "min",  "multiple",  "muted",  "name",  "novalidate",  "open",  "optimum",  "pattern",  "ping",  "placeholder",  "poster",  "preload",  "radiogroup",  "readonly",  "referrerpolicy",  "rel",  "required",  "reversed",  "rows",  "rowspan",  "sandbox",  "scope",  "scoped",  "selected",  "shape",  "size",  "sizes",  "slot",  "span",  "spellcheck",  "src",  "srcdoc",  "srclang",  "srcset",  "start",  "step",  "style",  "summary",  "tabindex",  "target",  "title",  "translate",  "type",  "usemap",  "value",  "width",  "wrap",  ...htmlEventHandlers ]); const isAnHtmlAttribute = (string)=>{  if (fixedAttributes.has(string)) {  return true;  } else if (string.startsWith("data-")) {  return true;  }  return false; }; const cssHmtlOverlap = new Set([  "width",  "height",  "background",  "border",  "color" ]); const splitHtmlCssAttributes = (object)=>{  const htmlAttributes = {};  const cssAttributes = {};  for (const [key, value] of Object.entries(object)){  if (cssHmtlOverlap.has(key)) {  htmlAttributes[key] = value;  cssAttributes[key] = value;  } else if (isAnHtmlAttribute(key)) {  htmlAttributes[key] = value;  } else {  cssAttributes[key] = value;  }  }  return [  htmlAttributes,  cssAttributes  ]; }; const computeDirection = (row, column, reverse)=>{  const output = row ? "row" : "column";  if (!reverse) {  return output;  } else {  return `${output}-reverse`;  } }; const humanPositionToCssPosition = (humanPosition)=>{  if (humanPosition === "relativeToParent") {  return "absolute";  } else if (humanPosition === "relativeToSelf") {  return "relative";  } else if (humanPosition === "relativeToWindow") {  return "fixed";  } else if (humanPosition === "sticky") {  return "sticky";  } else if (typeof humanPosition === "string") {  console.warn(`positionSelf needs to be one of [ 'relativeToParent', 'relativeToSelf', 'relativeToWindow', 'sticky' ] but instead it was: '${humanPosition}'`);  }  return void 0; }; const humanPositionToCssFlexbox = (humanWord)=>{  if (humanWord.match(/^(top|left)$/i)) {  return "flex-start";  } else if (humanWord.match(/^(bottom|right)$/i)) {  return "flex-end";  } else {  return humanWord;  } }; const columnAlignment = (horizontalAlignment, verticalAlignment, innerAlignment, wrap)=>{  if (!wrap) {  return {  justifyContent: verticalAlignment,  alignItems: horizontalAlignment  };  } else {  return {  justifyContent: verticalAlignment,  alignItems: innerAlignment,  alignContent: horizontalAlignment  };  } }; const rowAlignment = (horizontalAlignment, verticalAlignment, innerAlignment, wrap)=>{  if (!wrap) {  return {  justifyContent: horizontalAlignment,  alignItems: verticalAlignment  };  } else {  return {  justifyContent: horizontalAlignment,  alignItems: innerAlignment,  alignContent: verticalAlignment  };  } }; const computeFlexAlignmentAttributes = (directionIsRow, horizontalAlignment, verticalAlignment, innerAlignment, wrap)=>{  horizontalAlignment = humanPositionToCssFlexbox(horizontalAlignment);  verticalAlignment = humanPositionToCssFlexbox(verticalAlignment);  if (directionIsRow) {  return rowAlignment(horizontalAlignment, verticalAlignment, innerAlignment, wrap);  } else {  return columnAlignment(horizontalAlignment, verticalAlignment, innerAlignment, wrap);  } }; const setProperties = (element, properties)=>{  for (const [key, value] of Object.entries(properties)){  try {  const kebabCase = key.replace(/(?<=[a-z])([A-Z])(?=[a-z])/g, (each)=>`-${each.toLowerCase()}`  );  element.setAttribute(kebabCase, value);  } catch (error) {}  element[key] = value;  } }; const elementSymbol = Symbol.for("element"); function appendChildren1(element, ...children) {  for (const each of children){  if (typeof each == "string") {  element.appendChild(new window.Text(each));  } else if (each == null) {  element.appendChild(new window.Text(""));  } else if (!(each instanceof Object)) {  element.appendChild(new window.Text(`${each}`));  } else if (each[elementSymbol]) {  element.appendChild(each[elementSymbol]);  } else if (each instanceof Node) {  element.appendChild(each);  } else if (each instanceof Array) {  appendChildren1(element, ...each);  } else if (each instanceof Function) {  appendChildren1(element, each());  } else if (each instanceof Promise) {  const elementPromise = each;  const placeholder = elementPromise.placeholder || document.createElement("div");  setTimeout(async ()=>placeholder.replaceWith(await elementPromise)  , 0);  element.appendChild(placeholder);  } else if (each != null && each instanceof Object) {  element.appendChild(each);  }  }  return element; } var ContainerLibrary = ({ row , column , reverse , wrap , positionSelf ="relativeToSelf" , verticalAlignment ="top" , horizontalAlignment ="left" , innerAlignment ="center" , textWrapAlignment , children , ...props })=>{  const [htmlAttributes, cssAttributes] = splitHtmlCssAttributes(props);  const element = document.createElement("div");  Object.assign(element.style, {  position: humanPositionToCssPosition(positionSelf) || "relative",  display: "flex",  flexDirection: computeDirection(row, column, reverse),  flexWrap: wrap === "reverse" ? "wrap-reverse" : wrap && "wrap",  textAlign: textWrapAlignment || horizontalAlignment,  ...computeFlexAlignmentAttributes(row, horizontalAlignment, verticalAlignment, innerAlignment, wrap),  ...cssAttributes  });  setProperties(element, {  name: "positioner",  ...htmlAttributes  });  appendChildren1(element, children);  return element; }; return [ElementalLibrary, ContainerLibrary]})()
        // const { Elemental } = ElementalLibrary
        import { Elemental } from "https://deno.land/x/elementalist@0.5.34/main/deno.js?code"
        // import ContainerLibrary from "https://raw.githubusercontent.com/jeff-hykin/vanilla-container/master/main.mjs"
        const htmlEventHandlers = new Set(['onabort', 'onanimationcancel', 'onanimationend', 'onanimationiteration', 'onanimationstart', 'onauxclick', 'onblur', 'onerror', 'onfocus', 'oncancel', 'oncanplay', 'oncanplaythrough', 'onchange', 'onclick', 'onclose', 'oncontextmenu', 'oncuechange', 'ondblclick', 'ondrag', 'ondragend', 'ondragenter', 'ondragleave', 'ondragover', 'ondragstart', 'ondrop', 'ondurationchange', 'onemptied', 'onended', 'onformdata', 'ongotpointercapture', 'oninput', 'oninvalid', 'onkeydown', 'onkeypress', 'onkeyup', 'onload', 'onloadeddata', 'onloadedmetadata', 'onloadend', 'onloadstart', 'onlostpointercapture', 'onmousedown', 'onmouseenter', 'onmouseleave', 'onmousemove', 'onmouseout', 'onmouseover', 'onmouseup', 'onmousewheel', 'onwheel', 'onpause', 'onplay', 'onplaying', 'onpointerdown', 'onpointermove', 'onpointerup', 'onpointercancel', 'onpointerover', 'onpointerout', 'onpointerenter', 'onpointerleave', 'onpointerlockchange', 'onpointerlockerror', 'onprogress', 'onratechange', 'onreset', 'onresize', 'onscroll', 'onsecuritypolicyviolation', 'onseeked', 'onseeking', 'onselect', 'onselectstart', 'onselectionchange', 'onshow', 'onslotchange', 'onstalled', 'onsubmit', 'onsuspend', 'ontimeupdate', 'onvolumechange', 'ontouchcancel', 'ontouchend', 'ontouchmove', 'ontouchstart', 'ontransitioncancel', 'ontransitionend', 'ontransitionrun', 'ontransitionstart', 'onwaiting', ])
        const fixedAttributes = new Set(['accept', 'accept-charset', 'accesskey', 'action', 'align', 'allow', 'alt', 'async', 'autocapitalize', 'autocomplete', 'autofocus', 'autoplay', 'background', 'bgcolor', 'border', 'buffered', 'capture', 'challenge', 'charset', 'checked', 'cite', 'class', 'code', 'codebase', 'color', 'cols', 'colspan', 'content', 'contenteditable', 'contextmenu', 'controls', 'coords', 'crossorigin', 'csp', 'data', 'datetime', 'decoding', 'default', 'defer', 'dir', 'dirname', 'disabled', 'download', 'draggable', 'enctype', 'enterkeyhint', 'for', 'form', 'formaction', 'formenctype', 'formmethod', 'formnovalidate', 'formtarget', 'headers', 'height', 'hidden', 'high', 'href', 'hreflang', 'http-equiv', 'icon', 'id', 'importance', 'integrity', 'intrinsicsize', 'inputmode', 'ismap', 'itemprop', 'keytype', 'kind', 'label', 'lang', 'language', 'loading', 'list', 'loop', 'low', 'manifest', 'max', 'maxlength', 'minlength', 'media', 'method', 'min', 'multiple', 'muted', 'name', 'novalidate', 'open', 'optimum', 'pattern', 'ping', 'placeholder', 'poster', 'preload', 'radiogroup', 'readonly', 'referrerpolicy', 'rel', 'required', 'reversed', 'rows', 'rowspan', 'sandbox', 'scope', 'scoped', 'selected', 'shape', 'size', 'sizes', 'slot', 'span', 'spellcheck', 'src', 'srcdoc', 'srclang', 'srcset', 'start', 'step', 'style', 'summary', 'tabindex', 'target', 'title', 'translate', 'type', 'usemap', 'value', 'width', 'wrap', ...htmlEventHandlers]) 
        const isAnHtmlAttribute = (string) => {
            if (fixedAttributes.has(string)) {
                return true
            } else if (string.startsWith('data-')) {
                return true
            }
            return false
        }

        const cssHmtlOverlap = new Set(['width', 'height', 'background', 'border', 'color'])
        const splitHtmlCssAttributes = (object)=> {
            const htmlAttributes = {}
            const cssAttributes = {}
            for (const [key, value] of Object.entries(object)) {
                if (cssHmtlOverlap.has(key)) {
                    htmlAttributes[key] = value
                    cssAttributes[key] = value
                } else if (isAnHtmlAttribute(key)) {
                    htmlAttributes[key] = value
                } else {
                    cssAttributes[key] = value
                }
            }
            return [htmlAttributes, cssAttributes]
        }

        const computeDirection = (row, column, reverse) => {
            const output = row ? 'row' : 'column'
            if (!reverse) {
                return output
            } else {
                return `${output}-reverse`
            }
        }

        const humanPositionToCssPosition = (humanPosition) => {
            if (humanPosition === 'relativeToParent') {
                return 'absolute'
            } else if (humanPosition === 'relativeToSelf') {
                return 'relative'
            } else if (humanPosition === 'relativeToWindow') {
                return 'fixed'
            } else if (humanPosition === 'sticky') {
                return 'sticky'
            } else if (typeof humanPosition === 'string') {
                console.warn(`positionSelf needs to be one of [ 'relativeToParent', 'relativeToSelf', 'relativeToWindow', 'sticky' ]\nbut instead it was: '${humanPosition}'`)
            }
            return undefined
        }

        const humanPositionToCssFlexbox = (humanWord) => {
            if (humanWord.match(/^(top|left)$/i)) {
                return 'flex-start'
            } else if (humanWord.match(/^(bottom|right)$/i)) {
                return 'flex-end'
            } else {
                return humanWord
            }
        }

        const columnAlignment = (horizontalAlignment, verticalAlignment, innerAlignment, wrap) => {
            if (!wrap) {
                return {
                    justifyContent: verticalAlignment,
                    alignItems: horizontalAlignment,
                }
            } else {
                return {
                    // still just vertical space between
                    justifyContent: verticalAlignment,
                    // when wrapped this becomes the inner item alignment
                    alignItems: innerAlignment,
                    // when wrapped this becomes the horizontal space between
                    alignContent: horizontalAlignment,
                }
            }
        }

        const rowAlignment = (horizontalAlignment, verticalAlignment, innerAlignment, wrap) => {
            if (!wrap) {
                return {
                    justifyContent: horizontalAlignment,
                    alignItems: verticalAlignment,
                }
            } else {
                return {
                    // still just horizontal space between
                    justifyContent: horizontalAlignment,
                    // when wrapped this becomes the inner item alignment
                    alignItems: innerAlignment,
                    // when wrapped this becomes the vertical space between
                    alignContent: verticalAlignment,
                }
            }
        }

        const computeFlexAlignmentAttributes = (directionIsRow, horizontalAlignment, verticalAlignment, innerAlignment, wrap) => {
            // convert to css form
            horizontalAlignment = humanPositionToCssFlexbox(horizontalAlignment)
            verticalAlignment = humanPositionToCssFlexbox(verticalAlignment)
            // then pick the correct one
            if (directionIsRow) {
                return rowAlignment(horizontalAlignment, verticalAlignment, innerAlignment, wrap)
            } else {
                return columnAlignment(horizontalAlignment, verticalAlignment, innerAlignment, wrap)
            }
        }

        const setProperties = (element, properties)=>{
            for (const [key, value] of Object.entries(properties)) {
                try {
                    const kebabCase = key.replace(/(?<=[a-z])([A-Z])(?=[a-z])/g, (each)=>`-${each.toLowerCase()}`)
                    element.setAttribute(kebabCase, value)
                } catch (error) {
                }
                element[key] = value
            }
        }

        const elementSymbol = Symbol.for("element")
        function appendChildren(element, ...children) {
            for (const each of children) {
                if (typeof each == 'string') {
                    element.appendChild(new window.Text(each))
                } else if (each == null) {
                    // empty node
                    element.appendChild(new window.Text(""))
                } else if (!(each instanceof Object)) {
                    element.appendChild(new window.Text(`${each}`))
                } else if (each[elementSymbol]) {
                    element.appendChild(each[elementSymbol])
                } else if (each instanceof Node) {
                    element.appendChild(each)
                } else if (each instanceof Array) {
                    appendChildren(element, ...each)
                } else if (each instanceof Function) {
                    // recursively
                    appendChildren(element, each())
                } else if (each instanceof Promise) {
                    const elementPromise = each
                    const placeholder = elementPromise.placeholder || document.createElement("div")
                    setTimeout(async () => placeholder.replaceWith(await elementPromise), 0)
                    element.appendChild(placeholder)
                // some elements are not HTML nodes and are still valid
                } else if (each != null && each instanceof Object) {
                    element.appendChild(each)
                }
            }
            return element
        }

        const ContainerLibrary = ({ row, column, reverse, wrap, positionSelf='relativeToSelf', verticalAlignment='top', horizontalAlignment='left', innerAlignment='center', textWrapAlignment, children, ...props })=>{
            const [htmlAttributes, cssAttributes] = splitHtmlCssAttributes(props)
            const element = document.createElement("div")
            // 
            // style
            // 
            Object.assign(element.style, {
                position: humanPositionToCssPosition(positionSelf) || 'relative',
                display: 'flex',
                flexDirection: computeDirection(row, column, reverse),
                flexWrap: wrap === 'reverse' ? 'wrap-reverse' : (wrap&&'wrap'),
                // text-align (effects how text will look when wrapped)
                textAlign: textWrapAlignment || horizontalAlignment,
                // handle the justifyContent/alignContent attributes
                ...computeFlexAlignmentAttributes(
                    row,
                    horizontalAlignment,
                    verticalAlignment,
                    innerAlignment,
                    wrap,
                ),
                ...cssAttributes,
            })
            // 
            // attributes
            // 
            setProperties(element, {name: "positioner", ...htmlAttributes})
            appendChildren(element, children)
            return element
        }
        const nullFunc = ()=>0
        const addDynamicStylerFlags = (element, flagKeys) => {
            element.dynamicStyler = element.dynamicStyler||nullFunc
            for (const [attribute, positiveEvent, negativeEvent] of flagKeys) {
                element.addEventListener(positiveEvent, ()=>{
                    element[attribute] = true
                    element.dynamicStyler(element)
                })
                element.addEventListener(negativeEvent, ()=>{
                    element[attribute] = false
                    element.dynamicStyler(element)
                })
            }
        }
        
        class StopCallingListener {
            constructor({minDelay, callback,}) {
                this.callback = callback
                this.minDelay = minDelay
                this.timeoutId = null
            }
            call(func) {
                clearTimeout(this.timeoutId)
                this.timeoutId = setTimeout(func||this.func, this.minDelay)
            }
        }
        // import * as d3 from "https://cdn.skypack.dev/d3@v7.8.5"
        import * as d3 from "https://cdn.skypack.dev/d3@v5.16.0"
        // import * as d3 from "https://cdn.skypack.dev/d3@v4.13.0"
        
        // 
        // Custom elements
        // 
        const { html } = Elemental({
            Container: ContainerLibrary,
            Card,
            Chip,
            Title,
            AcheivementToken,
            Space,
            LinePadding,
            Graph,
        })
        
        // 
        // animations
        // 
        const [ fadeIn, fadeOut ] = [
            [
                [
                    { offset: 0.0, opacity: 0, },
                    { offset: 0.1, opacity: 0, },
                    { offset: 1.0, opacity: 1, },
                ], {
                    duration: 1000,
                    easing: 'ease-out',
                    iterations: 1
                }
            ],
            [
                [
                    { offset: 0.0, opacity: 1, },
                    { offset: 0.1, opacity: 1, },
                    { offset: 1.0, opacity: 0, },
                ], {
                    duration: 1000,
                    easing: 'ease-out',
                    iterations: 1
                }
            ],
        ]
    
    // 
    // 
    // Main Code
    // 
    // 
    let graphContainer
    let previewInfoContainer
    const bouncedListener = new StopCallingListener({minDelay: 400})
    let activeNode
    document.body = html`
        <body font-size=15px color=${theme.foregroundDim} overflow=hidden>
            <Container row height="fit-content" width="100%" background="var(--soft-gray-gradient)">
                ${window.previewInfoContainer = previewInfoContainer = html`<Container
                    name="SideBar"
                    column
                    flex-grow="1"
                    horizontalAlignment="center"
                    verticalAlignment="space-between"
                    height="100vh"
                    min-height="40em"
                    background="${theme.closeBackground}"
                    min-width=14em
                    max-width=28em
                    width=28em
                    padding=1.2rem
                    overflow=visible
                    z-index=1
                    box-shadow="0 4px 5px 0 rgba(0,0,0,0.14), 0 1px 10px 0 rgba(0,0,0,0.12), 0 2px 4px -1px rgba(0,0,0,0.3)"
                    >
                        <Container horizontalAlignment=center >
                            <span>Enter a DOI over there →</span>
                            <div height=3rem />
                            
                            <span>Example Paper DOI: <a href="https://sci-hub.se/10.1155/2014/413629">10.1155/2014/413629</a></span>
                        </Container>
                </Container>`}
                ${graphContainer = html`<Container
                    name="MainArea"
                    column
                    flex-grow="0"
                    horizontalAlignment="center"
                    verticalAlignment="space-between"
                    height="100vh"
                    min-height="40em"
                    background="${theme.farBackground}"
                    min-width=14em
                    overflow=auto
                    position=relative
                    >
                    <Graph
                        nodes=${[{ id: 'node1', year: "Howdy Howdy Howdy Howdy",  }, { id: 'node2' }, { id: 'node3' }]}
                        links=${[{ source: 'node1', target: 'node2' }, { source: 'node2', target: 'node3' }, { source: 'node3', target: 'node1' }]}
                        style="background: ${theme.farBackground}; width: 100%;"
                        onNodeClick=${(node)=>console.log(node)}
                        >
                    </Graph>
                </Container>`}
                <Container position="fixed" top=2rem right=1rem background=white padding=1rem border-radius=1rem color=black box-shadow="0 4px 5px 0 rgba(0,0,0,0.14), 0 1px 10px 0 rgba(0,0,0,0.12), 0 2px 4px -1px rgba(0,0,0,0.3)">
                    <input
                        width=24rem
                        outline=none
                        placeholder="Enter DOI like: 10.1155/2014/413629"
                        oninput=${(event)=>{
                            bouncedListener.call(()=>{
                                new Toastify({
                                    text: `loading new nodes`,
                                    position: 'right',
                                    backgroundColor: theme.accent,
                                    color: 'white',
                                    gravity: "bottom",
                                    duration: 8000,
                                }).showToast()
                                getNodesAndLinksFor(event.target.value).then(loadNewGraph).then(()=>{
                                    new Toastify({
                                        text: `Done ✅`,
                                        position: 'right',
                                        backgroundColor: theme.accent,
                                        color: 'white',
                                        gravity: "bottom",
                                        duration: 1000,
                                    }).showToast()
                                })
                            })
                        }}
                        border="0px solid black"
                        border-bottom="2px solid gray"
                        />
                </Container>
            </Container>
        </body>
    `
    document.body.animate(...fadeIn)
    // 
    // 
    // helpers
    // 
    // 
        let selectedNode
        function renderNodeSummary(nodeData) {
            // already selected
            if (selectedNode && selectedNode==nodeData.DOI) {
                return
            }
            selectedNode = nodeData.DOI
            let iframeWrapper
            const summary = html`
                <Container name=summary display=relative width=100% gap=1.4rem display=flex overflow=visible>
                    ${nodeData.title&&html`<h4 style="color: white;font-size: 1.5em;">${nodeData.title}</h4>`}
                    ${nodeData.authorLastName&&nodeData.yearCreated&&html`
                        <h5>
                            <a
                                href=${`https://sci-hub.hkvisa.net/${nodeData.DOI}`}
                                style="color: ${theme.foregroundDim};text-decoration: underline;font-size: 1rem;"
                                >
                                    ${nodeData.authorLastName}, ${nodeData.yearCreated}
                            </a>
                        </h5>
                    `}
                    <Container display=flex row horizontalAlignment=space-between width=100% verticalAlignment=center>
                        <button
                            style="cursor: pointer;"
                            background="${theme.accent}"
                            onclick=${()=>{
                                new Toastify({
                                    text: `loading new nodes`,
                                    position: 'right',
                                    backgroundColor: theme.accent,
                                    color: 'white',
                                    gravity: "bottom",
                                    duration: 8000,
                                }).showToast()
                                getNodesAndLinksFor(nodeData.id).then(loadNewGraph).then(()=>{
                                    new Toastify({
                                        text: `Done ✅`,
                                        position: 'right',
                                        backgroundColor: theme.accent,
                                        color: 'white',
                                        gravity: "bottom",
                                        duration: 1000,
                                    }).showToast()
                                })
                            }}
                            >
                                Recenter on this Node
                        </button>
                    </Container>
                    ${nodeData.DOI&&html`
                        ${iframeWrapper = html`
                            <div style="overflow: auto; max-width: 100%;" >
                                <iframe src="https://sci-hub.hkvisa.net/${nodeData.DOI}" height=800 width=1200></iframe>
                            </div>
                        `}
                    `}
                </Container>
            `
            if (iframeWrapper) {
                addDynamicStylerFlags(iframeWrapper, [
                    ['isHovered', 'mouseover', 'mouseout'],
                ])
                iframeWrapper.dynamicStyler = ()=>{
                    if (iframeWrapper.isHovered) {
                        iframeWrapper.style.overflow = "visible"
                    } else {
                        iframeWrapper.style.overflow = "auto"
                    }
                }
            }
            previewInfoContainer.replaceChild(summary,previewInfoContainer.children[0])
            
            previewInfoContainer.appendChild(summary)
            // DOI: "10.1016/j.neuroscience.2013.04.052"
            // cited: Array(66) [ "10.1016/0149-7634(80)90027-5", "10.1016/j.bbr.2007.10.010", "10.1046/j.1460-9568.2002.02043.x", … ]
            // citedBy: Array [ "10.1016/j.neuroscience.2013.04.052", "10.1155/2014/413629" ]
            // element: <circle id="10.1016/j.neuroscience.2013.04.052" r="5" style="fill: rgb(79, 79, 79); f…66); stroke-width: 0px;" cx="475.526965317753" cy="426.3633126531575">
            // id: "10.1016/j.neuroscience.2013.04.052"
            // title: "Individual differences in the effects of chronic stress on memory: Behavioral and neurochemical correlates of resiliency"
        }
        function getPaperInfo(paperOrDoi) {
            return window.paper = fetch(`https://api.crossref.org/works/${paperOrDoi?.DOI||paperOrDoi}`).then(result=>result.json()).then(result=>result.message)
            // result.DOI
            // result.abstract
            // result.author[0].given // first name
            // result.author[0].family // last name
            // result.created["date-time"] // string timestamp
            // result.title[0]
            // result["short-container-title"]
            // result["reference-count"]
            // {
            //     "status": "ok",
            //     "message-type": "work",
            //     "message-version": "1.0.0",
            //     "message": {
            //         "indexed": {
            //             "date-parts": [
            //                 [
            //                     2023,
            //                     9,
            //                     3
            //                 ]
            //             ],
            //             "date-time": "2023-09-03T04:57:00Z",
            //             "timestamp": 1693717020763
            //         },
            //         "reference-count": 60,
            //         "publisher": "Hindawi Limited",
            //         "license": [
            //             {
            //                 "start": {
            //                     "date-parts": [
            //                         [
            //                             2014,
            //                             1,
            //                             1
            //                         ]
            //                     ],
            //                     "date-time": "2014-01-01T00:00:00Z",
            //                     "timestamp": 1388534400000
            //                 },
            //                 "content-version": "unspecified",
            //                 "delay-in-days": 0,
            //                 "URL": "http://creativecommons.org/licenses/by/3.0/"
            //             }
            //         ],
            //         "funder": [
            //             {
            //                 "name": "ITMS 26240120020-Establishment of the Centre for the Research on Composite Materials for Structural Engineering and Medical Applications-CEKOMAT II.",
            //                 "award": [
            //                     "VEGA 2/0084/10",
            //                     "APVV-0523-10"
            //                 ]
            //             }
            //         ],
            //         "content-domain": {
            //             "domain": [],
            //             "crossmark-restriction": false
            //         },
            //         "short-container-title": [
            //             "BioMed Research International"
            //         ],
            //         "published-print": {
            //             "date-parts": [
            //                 [
            //                     2014
            //                 ]
            //             ]
            //         },
            //         "abstract": "<jats:p>This study investigated the influence of chronic crowding stress on nitric oxide (NO) production, vascular function and oxidative status in young Wistar-Kyoto (WKY), borderline hypertensive (BHR) and spontaneously hypertensive (SHR) female rats. Five-week old rats were exposed to crowding for two weeks. Crowding elevated plasma corticosterone<mml:math xmlns:mml=\"http://www.w3.org/1998/Math/MathML\" id=\"M1\"><mml:mo stretchy=\"false\">(</mml:mo><mml:mi>P</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.05</mml:mn><mml:mo stretchy=\"false\">)</mml:mo></mml:math>and accelerated BP (<mml:math xmlns:mml=\"http://www.w3.org/1998/Math/MathML\" id=\"M2\"><mml:mi>P</mml:mi><mml:mo>&lt;</mml:mo><mml:mn>0.01</mml:mn></mml:math>versus basal) only in BHR. NO production and superoxide concentration were significantly higher in the aortas of control BHR and SHR versus WKY. Total acetylcholine (ACh)-induced relaxation in the femoral artery was reduced in control SHR versus WKY and BHR, and stress did not affect it significantly in any genotype. The attenuation of ACh-induced relaxation in SHR versus WKY was associated with reduction of its NO-independent component. Crowding elevated NO production in all strains investigated but superoxide concentration was increased only in WKY, which resulted in reduced NO-dependent relaxation in WKY. In crowded BHR and SHR, superoxide concentration was either unchanged or reduced, respectively, but NO-dependent relaxation was unchanged in both BHR and SHR versus their respective control group. This study points to genotype-related differences in stress vulnerability in young female rats. The most pronounced negative influence of stress was observed in BHR despite preserved endothelial function.</jats:p>",
            //         "DOI": "10.1155/2014/413629",
            //         "type": "journal-article",
            //         "created": {
            //             "date-parts": [
            //                 [
            //                     2014,
            //                     3,
            //                     9
            //                 ]
            //             ],
            //             "date-time": "2014-03-09T09:21:03Z",
            //             "timestamp": 1394356863000
            //         },
            //         "page": "1-11",
            //         "source": "Crossref",
            //         "is-referenced-by-count": 17,
            //         "title": [
            //             "Genotype-Related Effect of Crowding Stress on Blood Pressure and Vascular Function in Young Female Rats"
            //         ],
            //         "prefix": "10.1155",
            //         "volume": "2014",
            //         "author": [
            //             {
            //                 "ORCID": "http://orcid.org/0000-0001-9757-3283",
            //                 "authenticated-orcid": true,
            //                 "given": "Peter",
            //                 "family": "Slezak",
            //                 "sequence": "first",
            //                 "affiliation": [
            //                     {
            //                         "name": "Institute of Normal and Pathological Physiology, Centre of Excellence for Examination of Regulatory Role of Nitric Oxide in Civilization Diseases, Slovak Academy of Sciences, Sienkiewiczova 1, 813 71 Bratislava, Slovakia"
            //                     }
            //                 ]
            //             },
            //             {
            //                 "given": "Angelika",
            //                 "family": "Puzserova",
            //                 "sequence": "additional",
            //                 "affiliation": [
            //                     {
            //                         "name": "Institute of Normal and Pathological Physiology, Centre of Excellence for Examination of Regulatory Role of Nitric Oxide in Civilization Diseases, Slovak Academy of Sciences, Sienkiewiczova 1, 813 71 Bratislava, Slovakia"
            //                     }
            //                 ]
            //             },
            //             {
            //                 "given": "Peter",
            //                 "family": "Balis",
            //                 "sequence": "additional",
            //                 "affiliation": [
            //                     {
            //                         "name": "Institute of Normal and Pathological Physiology, Centre of Excellence for Examination of Regulatory Role of Nitric Oxide in Civilization Diseases, Slovak Academy of Sciences, Sienkiewiczova 1, 813 71 Bratislava, Slovakia"
            //                     }
            //                 ]
            //             },
            //             {
            //                 "given": "Natalia",
            //                 "family": "Sestakova",
            //                 "sequence": "additional",
            //                 "affiliation": [
            //                     {
            //                         "name": "Institute of Normal and Pathological Physiology, Centre of Excellence for Examination of Regulatory Role of Nitric Oxide in Civilization Diseases, Slovak Academy of Sciences, Sienkiewiczova 1, 813 71 Bratislava, Slovakia"
            //                     }
            //                 ]
            //             },
            //             {
            //                 "ORCID": "http://orcid.org/0000-0001-8748-4279",
            //                 "authenticated-orcid": true,
            //                 "given": "Miroslava",
            //                 "family": "Majzunova",
            //                 "sequence": "additional",
            //                 "affiliation": [
            //                     {
            //                         "name": "Institute of Normal and Pathological Physiology, Centre of Excellence for Examination of Regulatory Role of Nitric Oxide in Civilization Diseases, Slovak Academy of Sciences, Sienkiewiczova 1, 813 71 Bratislava, Slovakia"
            //                     }
            //                 ]
            //             },
            //             {
            //                 "given": "Ima",
            //                 "family": "Dovinova",
            //                 "sequence": "additional",
            //                 "affiliation": [
            //                     {
            //                         "name": "Institute of Normal and Pathological Physiology, Centre of Excellence for Examination of Regulatory Role of Nitric Oxide in Civilization Diseases, Slovak Academy of Sciences, Sienkiewiczova 1, 813 71 Bratislava, Slovakia"
            //                     }
            //                 ]
            //             },
            //             {
            //                 "given": "Michal",
            //                 "family": "Kluknavsky",
            //                 "sequence": "additional",
            //                 "affiliation": [
            //                     {
            //                         "name": "Institute of Normal and Pathological Physiology, Centre of Excellence for Examination of Regulatory Role of Nitric Oxide in Civilization Diseases, Slovak Academy of Sciences, Sienkiewiczova 1, 813 71 Bratislava, Slovakia"
            //                     }
            //                 ]
            //             },
            //             {
            //                 "ORCID": "http://orcid.org/0000-0002-6120-706X",
            //                 "authenticated-orcid": true,
            //                 "given": "Iveta",
            //                 "family": "Bernatova",
            //                 "sequence": "additional",
            //                 "affiliation": [
            //                     {
            //                         "name": "Institute of Normal and Pathological Physiology, Centre of Excellence for Examination of Regulatory Role of Nitric Oxide in Civilization Diseases, Slovak Academy of Sciences, Sienkiewiczova 1, 813 71 Bratislava, Slovakia"
            //                     }
            //                 ]
            //             }
            //         ],
            //         "member": "98",
            //         "reference": [
            //             {
            //                 "issue": "4",
            //                 "key": "1",
            //                 "doi-asserted-by": "crossref",
            //                 "first-page": "141",
            //                 "DOI": "10.1080/08964280209596039",
            //                 "volume": "27",
            //                 "year": "2002",
            //                 "journal-title": "Behavioral Medicine"
            //             },
            //             {
            //                 "key": "2",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1016/j.brainresbull.2003.12.001"
            //             },
            //             {
            //                 "key": "3",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1016/S0140-6736(04)17019-0"
            //             },
            //             {
            //                 "key": "4",
            //                 "first-page": "1",
            //                 "volume-title": "Introduction to cardiovascular disease, stress and adaptation",
            //                 "year": "2012"
            //             },
            //             {
            //                 "key": "5",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1111/j.1440-1681.2008.04904.x"
            //             },
            //             {
            //                 "key": "6",
            //                 "first-page": "273",
            //                 "volume-title": "The causal role of chronic mental stress in the pathogenesis of essential hypertension",
            //                 "year": "2012"
            //             },
            //             {
            //                 "key": "7",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1186/1471-2458-8-357"
            //             },
            //             {
            //                 "key": "8",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1038/jhh.2008.74"
            //             },
            //             {
            //                 "key": "9",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1007/s10571-011-9768-0"
            //             },
            //             {
            //                 "issue": "4",
            //                 "key": "10",
            //                 "doi-asserted-by": "crossref",
            //                 "first-page": "1227",
            //                 "DOI": "10.1152/physrev.1999.79.4.1227",
            //                 "volume": "79",
            //                 "year": "1999",
            //                 "journal-title": "Physiological Reviews"
            //             },
            //             {
            //                 "key": "11",
            //                 "first-page": "S9",
            //                 "volume": "61",
            //                 "year": "2012",
            //                 "journal-title": "Physiological Research"
            //             },
            //             {
            //                 "key": "12",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1042/CS20050271"
            //             },
            //             {
            //                 "issue": "3",
            //                 "key": "13",
            //                 "first-page": "367",
            //                 "volume": "50",
            //                 "year": "1999",
            //                 "journal-title": "Journal of Physiology and Pharmacology"
            //             },
            //             {
            //                 "issue": "1",
            //                 "key": "14",
            //                 "first-page": "67",
            //                 "volume": "52",
            //                 "year": "2003",
            //                 "journal-title": "Physiological Research"
            //             },
            //             {
            //                 "key": "15",
            //                 "doi-asserted-by": "crossref",
            //                 "first-page": "331",
            //                 "volume": "16",
            //                 "year": "2013",
            //                 "journal-title": "Stress",
            //                 "DOI": "10.3109/10253890.2012.725116"
            //             },
            //             {
            //                 "key": "16",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1023/A:1016627224865"
            //             },
            //             {
            //                 "key": "17",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1007/s00424-011-1022-6"
            //             },
            //             {
            //                 "issue": "5",
            //                 "key": "18",
            //                 "first-page": "667",
            //                 "volume": "56",
            //                 "year": "2007",
            //                 "journal-title": "Physiological Research"
            //             },
            //             {
            //                 "issue": "6",
            //                 "key": "19",
            //                 "doi-asserted-by": "crossref",
            //                 "first-page": "854",
            //                 "DOI": "10.1161/01.HYP.26.6.854",
            //                 "volume": "26",
            //                 "year": "1995",
            //                 "journal-title": "Hypertension"
            //             },
            //             {
            //                 "key": "20",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1080/10253890802234168"
            //             },
            //             {
            //                 "issue": "2",
            //                 "key": "21",
            //                 "first-page": "103",
            //                 "volume": "59",
            //                 "year": "2008",
            //                 "journal-title": "Journal of Physiology and Pharmacology"
            //             },
            //             {
            //                 "key": "22",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1016/j.physbeh.2009.05.011"
            //             },
            //             {
            //                 "key": "23",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1097/01.hjh.0000358834.18311.fc"
            //             },
            //             {
            //                 "key": "24",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1016/S0008-6363(01)00508-9"
            //             },
            //             {
            //                 "key": "25",
            //                 "doi-asserted-by": "crossref",
            //                 "first-page": "897",
            //                 "volume": "2",
            //                 "year": "2010",
            //                 "journal-title": "Health",
            //                 "DOI": "10.4236/health.2010.28133"
            //             },
            //             {
            //                 "key": "26",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1016/j.biopsycho.2004.11.009"
            //             },
            //             {
            //                 "key": "27",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1007/s10517-007-0043-9"
            //             },
            //             {
            //                 "key": "29",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1016/j.niox.2011.12.008"
            //             },
            //             {
            //                 "key": "30",
            //                 "first-page": "73",
            //                 "volume-title": "Measurement of vascular reactive oxygen species production by chemiluminescence",
            //                 "year": "2005"
            //             },
            //             {
            //                 "issue": "4",
            //                 "key": "31",
            //                 "first-page": "405",
            //                 "volume": "13",
            //                 "year": "1995",
            //                 "journal-title": "Journal of Hypertension"
            //             },
            //             {
            //                 "key": "32",
            //                 "doi-asserted-by": "crossref",
            //                 "first-page": "2611",
            //                 "volume": "38",
            //                 "year": "2013",
            //                 "journal-title": "Psychoneuroendocrinology",
            //                 "DOI": "10.1016/j.psyneuen.2013.06.014"
            //             },
            //             {
            //                 "key": "33",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1016/j.appet.2012.02.046"
            //             },
            //             {
            //                 "key": "34",
            //                 "doi-asserted-by": "crossref",
            //                 "first-page": "217",
            //                 "volume": "177",
            //                 "year": "2013",
            //                 "journal-title": "Autonomic Neuroscience",
            //                 "DOI": "10.1016/j.autneu.2013.05.001"
            //             },
            //             {
            //                 "key": "35",
            //                 "doi-asserted-by": "crossref",
            //                 "first-page": "142",
            //                 "volume": "246",
            //                 "year": "2013",
            //                 "journal-title": "Neuroscience",
            //                 "DOI": "10.1016/j.neuroscience.2013.04.052"
            //             },
            //             {
            //                 "key": "36",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1186/1744-9081-7-11"
            //             },
            //             {
            //                 "key": "37",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1113/jphysiol.2007.141580"
            //             },
            //             {
            //                 "key": "38",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1016/j.nlm.2008.07.001"
            //             },
            //             {
            //                 "key": "39",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.3109/10253890.2011.586446"
            //             },
            //             {
            //                 "issue": "3",
            //                 "key": "40",
            //                 "first-page": "487",
            //                 "volume": "58",
            //                 "year": "2007",
            //                 "journal-title": "Journal of Physiology and Pharmacology"
            //             },
            //             {
            //                 "key": "41",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1152/ajpregu.00095.2008"
            //             },
            //             {
            //                 "key": "42",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1113/expphysiol.2010.055970"
            //             },
            //             {
            //                 "issue": "5",
            //                 "key": "43",
            //                 "doi-asserted-by": "crossref",
            //                 "first-page": "R527",
            //                 "DOI": "10.1152/ajpregu.1985.249.5.R527",
            //                 "volume": "249",
            //                 "year": "1985",
            //                 "journal-title": "American Journal of Physiology—Regulatory Integrative and Comparative Physiology"
            //             },
            //             {
            //                 "key": "44",
            //                 "first-page": "111",
            //                 "volume": "116",
            //                 "year": "2002",
            //                 "journal-title": "Indian Journal of Medical Research"
            //             },
            //             {
            //                 "key": "45",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1016/0031-9384(96)00020-0"
            //             },
            //             {
            //                 "key": "46",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1007/s00467-011-1928-4"
            //             },
            //             {
            //                 "key": "47",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1155/2013/427640"
            //             },
            //             {
            //                 "key": "48",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1016/j.jacc.2005.03.068"
            //             },
            //             {
            //                 "key": "49",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1074/jbc.271.39.23928"
            //             },
            //             {
            //                 "key": "50",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1007/s00424-010-0797-1"
            //             },
            //             {
            //                 "key": "51",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1016/j.physbeh.2011.09.017"
            //             },
            //             {
            //                 "key": "52",
            //                 "first-page": "615",
            //                 "volume": "62",
            //                 "year": "2013",
            //                 "journal-title": "Physiological Research"
            //             },
            //             {
            //                 "key": "53",
            //                 "doi-asserted-by": "crossref",
            //                 "first-page": "233",
            //                 "volume": "16",
            //                 "year": "2013",
            //                 "journal-title": "Stress",
            //                 "DOI": "10.3109/10253890.2012.719052"
            //             },
            //             {
            //                 "issue": "1",
            //                 "key": "54",
            //                 "first-page": "53",
            //                 "volume": "46",
            //                 "year": "2009",
            //                 "journal-title": "Indian Journal of Biochemistry and Biophysics"
            //             },
            //             {
            //                 "key": "61",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1161/01.RES.0000082524.34487.31"
            //             },
            //             {
            //                 "key": "55",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1124/pr.59.3.3"
            //             },
            //             {
            //                 "issue": "6",
            //                 "key": "56",
            //                 "doi-asserted-by": "crossref",
            //                 "first-page": "R1719",
            //                 "DOI": "10.1152/ajpregu.2001.280.6.R1719",
            //                 "volume": "280",
            //                 "year": "2001",
            //                 "journal-title": "American Journal of Physiology—Regulatory Integrative and Comparative Physiology"
            //             },
            //             {
            //                 "key": "59"
            //             },
            //             {
            //                 "issue": "4",
            //                 "key": "60",
            //                 "doi-asserted-by": "crossref",
            //                 "first-page": "393",
            //                 "DOI": "10.1161/01.HYP.12.4.393",
            //                 "volume": "12",
            //                 "year": "1988",
            //                 "journal-title": "Hypertension"
            //             },
            //             {
            //                 "key": "57",
            //                 "doi-asserted-by": "crossref",
            //                 "first-page": "341",
            //                 "volume": "78",
            //                 "year": "2013",
            //                 "journal-title": "Steroids",
            //                 "DOI": "10.1016/j.steroids.2012.11.018"
            //             },
            //             {
            //                 "key": "58",
            //                 "doi-asserted-by": "publisher",
            //                 "DOI": "10.1097/00004872-200309000-00019"
            //             }
            //         ],
            //         "container-title": [
            //             "BioMed Research International"
            //         ],
            //         "original-title": [],
            //         "language": "en",
            //         "link": [
            //             {
            //                 "URL": "http://downloads.hindawi.com/journals/bmri/2014/413629.pdf",
            //                 "content-type": "application/pdf",
            //                 "content-version": "vor",
            //                 "intended-application": "text-mining"
            //             },
            //             {
            //                 "URL": "http://downloads.hindawi.com/journals/bmri/2014/413629.xml",
            //                 "content-type": "application/xml",
            //                 "content-version": "vor",
            //                 "intended-application": "text-mining"
            //             },
            //             {
            //                 "URL": "http://downloads.hindawi.com/journals/bmri/2014/413629.pdf",
            //                 "content-type": "unspecified",
            //                 "content-version": "vor",
            //                 "intended-application": "similarity-checking"
            //             }
            //         ],
            //         "deposited": {
            //             "date-parts": [
            //                 [
            //                     2019,
            //                     8,
            //                     8
            //                 ]
            //             ],
            //             "date-time": "2019-08-08T08:38:00Z",
            //             "timestamp": 1565253480000
            //         },
            //         "score": 1,
            //         "resource": {
            //             "primary": {
            //                 "URL": "http://www.hindawi.com/journals/bmri/2014/413629/"
            //             }
            //         },
            //         "subtitle": [],
            //         "short-title": [],
            //         "issued": {
            //             "date-parts": [
            //                 [
            //                     2014
            //                 ]
            //             ]
            //         },
            //         "references-count": 60,
            //         "alternative-id": [
            //             "413629",
            //             "413629"
            //         ],
            //         "URL": "http://dx.doi.org/10.1155/2014/413629",
            //         "relation": {},
            //         "ISSN": [
            //             "2314-6133",
            //             "2314-6141"
            //         ],
            //         "issn-type": [
            //             {
            //                 "value": "2314-6133",
            //                 "type": "print"
            //             },
            //             {
            //                 "value": "2314-6141",
            //                 "type": "electronic"
            //             }
            //         ],
            //         "subject": [
            //             "General Immunology and Microbiology",
            //             "General Biochemistry, Genetics and Molecular Biology",
            //             "General Medicine"
            //         ],
            //         "published": {
            //             "date-parts": [
            //                 [
            //                     2014
            //                 ]
            //             ]
            //         }
            //     }
            // }
        }
        async function getNodesAndLinksFor(paperOrDoi, limit=Infinity) {
            const paperInfo = await getPaperInfo(paperOrDoi)
            const dois = (paperInfo?.reference||[]).map(each=>each.DOI).filter(each=>each).slice(0,limit)
            const relatedPapers = await Promise.all(
                dois.map(each=>getPaperInfo(each))
            )
            const papers = Object.fromEntries(zip(dois, relatedPapers))
            papers[paperInfo.DOI] = paperInfo
            // NOTE: some references don't have a DOI
            // "key": "4",
            // "first-page": "1",
            // "volume-title": "Introduction to cardiovascular disease, stress and adaptation",
            // "year": "2012"
            const nodesById = {}
            for (const [eachDoi, eachPaper] of Object.entries(papers)) {
                eachPaper.DOI = eachDoi
                let yearCreated = ""
                try {
                    yearCreated = eachPaper.created["date-parts"][0][0]
                } catch (error) {
                    
                }
                const node = {
                    id: eachPaper.DOI || `${Math.random()}`,
                    DOI: eachPaper.DOI,
                    title: (eachPaper.title||[]),
                    authorLastName: (eachPaper?.author?.length>0 ? eachPaper.author[0].family : ""),
                    yearCreated,
                    citedBy: [
                    ],
                    cited: (eachPaper.reference||[]).map(each=>each.DOI).filter(each=>each),
                }
                if (node.title instanceof Array) {
                    node.title = node.title[0]
                }
                nodesById[node.id] = node
            }
            const links = []
            for (const [eachId, eachNode] of Object.entries(nodesById)) {
                for (const eachDoi of eachNode.cited) {
                    const otherNode = nodesById[eachDoi]
                    if (otherNode) {
                        otherNode.citedBy.push(eachNode.id)
                        links.push({
                            sourceTitle: otherNode.title,
                            source: otherNode.id,
                            targetTitle: eachNode.title,
                            target: eachId,
                        })
                    }
                }
            }
            return {nodes: Object.values(nodesById), links}
        }
        const loadNewGraph = ({nodes, links})=>{
            const newGraph = html`
                    <Graph
                        nodes=${nodes}
                        links=${links}
                        style="background: ${theme.farBackground}; width: 100%; color: ${theme.foregroundBright}"
                        onNodeClick=${(node)=>{
                            activeNode = node
                            renderNodeSummary(activeNode)
                        }}
                        >
                    </Graph>
                `
            graphContainer.replaceChild(
                newGraph,
                graphContainer.children[0],
            )
        }
        getNodesAndLinksFor().then(loadNewGraph)
    // 
    // 
    // Components
    // 
    // 
        function Space() {
            const element = document.createElement("code")
            element.style.whiteSpace = "pre"
            element.style.minWidth = "0.3em"
            return element
        }
        
        /**
         * create graph
         *
         * @example
         * ```js
         * const nodes = [{ id: 'node1' }, { id: 'node2' }, { id: 'node3' }]
         * const links = [{ source: 'node1', target: 'node2' }, { source: 'node2', target: 'node3' }, { source: 'node3', target: 'node1' }]
         * ```
         *
         * @param arg1 - description
         * @param arg1.parameter - description
         * @returns {Object} output - description
         * @returns output.x - description
         *
         */
        function Graph({nodes, links, style={}, nodeSize=18, nodeColor=theme.accent, minZoom=0.5, maxZoom=2, onNodeClick, labelAnchor="left", labelSize="10pt", }) {
            try {
                
                const graph = html`<div></div>`
                graph.style.display = "flexbox"
                graph.style.alignItems = "center"
                graph.style.alignContent = "center"
                graph.style.overflow = "hidden"
                const givenStyles = (html`<div style=${style}></div>`).style
                for (const key of Object.values(givenStyles)) {
                    graph.style[key] = givenStyles[key]
                }
                // Object.assign(graph.style, (html`<div style=${style}></div>`).style)
                const height = window.screen.height
                const width = window.screen.width
                const element = html`<svg height=${height} width=${width}></svg>`
                const svg = d3.select(element)
                const nodeDataById = {}
                for (let each of nodes) {
                    nodeDataById[each.id] = each
                }
                
                // add Zooming and panning
                const container = svg.append("g");
                svg.call(
                    d3.zoom()
                        .scaleExtent([ minZoom, maxZoom ]) // Set the minimum and maximum zoom levels
                        .on("zoom", ()=>container.attr("transform", d3.event.transform))
                )

                const link = container.append("g")
                    .selectAll("line")
                    .data(links)
                    .enter().append("line")

                link
                    .style("stroke", "#aaaaaa50")
                    .style("stroke-width", "4px")
                
                const years = nodes.map(each=>each.yearCreated).filter(each=>each)
                const largestYear = Math.max(...years)
                const smallestYear = Math.min(...years)
                const yearRange = largestYear-smallestYear
                const normalizer = (year)=>year&&((year-smallestYear)/yearRange)
                    
                const node = container.append("g")
                    .attr("class", "nodes")
                    .selectAll("circle")
                    .data(nodes)
                    .enter().append("circle")
                    //I made the article/source nodes larger than the entity nodes
                    .attr("r", each=>each.size != null? each.size: nodeSize+(35*Math.pow(normalizer(each.yearCreated),1.7))-5)
                    .attr("id", each=>each.id)
                
                if (onNodeClick) {
                    node.on("click", onNodeClick)
                }
                node.on("mouseover", renderNodeSummary)
                node.on("mouseout", ()=>activeNode&&renderNodeSummary(activeNode))
                
                
                for (const each of element.querySelectorAll("circle")) {
                    nodeDataById[each.id].element = each
                }
                
                
                node
                    .style("fill", nodeColor)
                    .style("fill-opacity","1")
                    .style("stroke", "#00000000")
                    .style("stroke-width", "0px")
                
                const label = container.append("g")
                    .attr("class", "labels")
                    .selectAll("text")
                    .data(nodes)
                    .enter().append("text")
                    .text(each=>each.authorLastName&&each.yearCreated? `${each.authorLastName}, ${each.yearCreated}`:"")
                    .attr("class", "label")

                label
                    .style("text-anchor", labelAnchor)
                    .style("font-size", labelSize)
                    .style("fill", theme.foregroundBright)
                
                const simulation = d3.forceSimulation(nodes)
                simulation.force('link', d3.forceLink(links).id(d => d.id))
                simulation.force('charge', d3.forceManyBody().strength(-4000))  // Increase strength to add padding
                simulation.force('center', d3.forceCenter(width/2, height/2))
                
                simulation.on('tick', () => {
                    link
                        .attr("x1", (d)=>d.source.x-1)
                        .attr("y1", (d)=>d.source.y-1)
                        .attr("x2", (d)=>d.target.x-1)
                        .attr("y2", (d)=>d.target.y-1)

                    node
                        .attr("cx", (d)=>d.x+5)
                        .attr("cy", (d)=>d.y-3)

                    label
                        .attr("x",
                            (d,index,labels)=>{
                                const label = labels[index]
                                // const element = nodeDataById[d.id].element
                                // const nodeRadius = element.getAttribute("r")-0
                                // const nodeStrokeWidth = getComputedStyle(element).strokeWidth.slice(0,-(("px").length))-0
                                // // for whatever reason, visually this is always off by "3"
                                // // which is why 3 is added here
                                // return nodeRadius + nodeStrokeWidth + 3 + d.x
                                const {left,right} = label.getBoundingClientRect()
                                window.label = label
                                window.d = d
                                return d.x - (Math.abs(left-right)/2)
                            }
                        )
                        .attr("y",
                            (d)=>{
                                const element = nodeDataById[d.id].element
                                const nodeRadius = element.getAttribute("r")-0
                                const nodeStrokeWidth = getComputedStyle(element).strokeWidth.slice(0,-(("px").length))-0
                                // for whatever reason, visually this is always off by "3"
                                // which is why 3 is added here
                                return d.y - (nodeRadius + nodeStrokeWidth + 3)
                            }
                        )
                })
                
                graph.appendChild(element)
                return graph
            } catch (error) {
                console.debug(`error is:`,error)
                console.log(error.stack)
                return html`<span>Error ${error}</span>`
            }
        }

        function Title({underline, thin, size, style, children, color, ...props}) {
            style = {
                flexGrow: 0,
                fontSize: size||"1.5em",
                marginBottom: "0.7em",
                // add underline or not
                ...(underline ? {
                    borderBottom: "2px solid "+(color||"gray"),
                    fontSize: size||"1.3em",
                }:{}),
                ...(thin ? {
                    fontWeight: 100,
                }:{}),
                ...(thin && underline ? {
                    borderBottom: "1px solid "+(color||"gray"),
                }:{}),
                color,
                ...style,
                ...props,
            }
            const element = html`
                <h4 ...${props} >
                        ${children}
                </h4>
            `
            // this next line shouldn't be necessary, I'm not sure why it is (but I know that it is)
            Object.assign(element.style, style)
            return element
        }
        
        function LinePadding() {
            return html`<Container class="line-padding" min-height=0.4em />`
        }
        
        function Card({name, children, ...props}) {
            return html`
                <Container
                    name=${name}
                    border-radius="1em"
                    box-shadow="0 4px 5px 0 rgba(0,0,0,0.10),0 1px 10px 0 rgba(0,0,0,0.08),0 2px 4px -1px rgba(0,0,0,0.24)"
                    padding="1.5em 2em"
                    background="var(--card-background, white)"
                    ...${props}
                    >
                        ${children}
                </Container>
            `
        }
        
        function Chip({name, color, children, ...props}) {
            return html`
                <Container
                    name=${name}
                    border-radius="2em"
                    padding="0.35em 0.7em"
                    margin="0.15em"
                    background=${color||"rgba(255,255,255,0.25)"}
                    backdrop-filter=${color?"":"saturate(180%) brightness(1.05)"}
                    color="white"
                    font-size="0.8em"
                    display="inline-block"
                    max-width="max-content"
                    min-width="max-content"
                    cursor="default"
                    ...${props}
                    >
                        ${children}
                </Container>
            `
        }
        
        function AcheivementToken({children, ...props}) {
            return html`
                <Container
                    border-radius="2em"
                    border="2px solid white"
                    box-shadow="0 4px 5px 0 rgba(0,0,0,0.10),0 1px 10px 0 rgba(0,0,0,0.08),0 2px 4px -1px rgba(0,0,0,0.24)"
                    margin-bottom="1em"
                    ...${props}
                    > 
                        <Container
                            border-radius="2em"
                            border="5px solid #E5C07B"
                            padding="0.6em 1em"
                            font-size="1em"
                            background-color="white"
                            row
                            > 
                                ${children}
                        </Container>
                </Container>
            `
        }
        
// })()
</script>
